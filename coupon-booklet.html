<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ğŸ’Œ Erin's Coupon Booklet</title>
<link href="https://fonts.googleapis.com/css2?family=Fredoka+One&family=Nunito:wght@400;600;700;800&display=swap" rel="stylesheet">
<style>
  :root {
    --pink: #FF6B9D;
    --bg: #FFF5F8;
    --dark: #2D2D2D;
  }
  * { box-sizing: border-box; margin: 0; padding: 0; }
  body { font-family: 'Nunito', sans-serif; background: var(--bg); min-height: 100vh; overflow-x: hidden; }

  /* COVER */
  .cover {
    min-height: 100vh;
    background: linear-gradient(135deg, #FF6B9D 0%, #FF8C69 50%, #FFE566 100%);
    display: flex; flex-direction: column; align-items: center; justify-content: center;
    padding: 40px 24px; text-align: center; position: relative; overflow: hidden;
  }
  .ticker { position: absolute; top: 0; left: 0; right: 0; font-size: 20px; letter-spacing: 6px; opacity: 0.15; white-space: nowrap; overflow: hidden; padding: 10px 0; }
  .ticker-inner { display: inline-block; animation: ticker 22s linear infinite; }
  @keyframes ticker { from { transform: translateX(0); } to { transform: translateX(-50%); } }
  .cover-badge { background: white; color: var(--pink); font-family: 'Fredoka One', cursive; font-size: 12px; letter-spacing: 3px; text-transform: uppercase; padding: 6px 20px; border-radius: 20px; margin-bottom: 24px; box-shadow: 0 4px 14px rgba(0,0,0,0.12); }
  .cover-heart { font-size: 88px; animation: pulse 1.6s ease-in-out infinite; margin-bottom: 20px; filter: drop-shadow(0 6px 16px rgba(0,0,0,0.15)); }
  @keyframes pulse { 0%,100% { transform: scale(1); } 50% { transform: scale(1.13); } }
  .cover-title { font-family: 'Fredoka One', cursive; font-size: clamp(44px, 13vw, 76px); color: white; line-height: 1.05; text-shadow: 4px 4px 0 rgba(0,0,0,0.1); margin-bottom: 12px; }
  .cover-sub { font-size: 17px; color: white; font-weight: 700; opacity: 0.88; margin-bottom: 36px; max-width: 300px; line-height: 1.5; }
  .scroll-hint { background: rgba(255,255,255,0.25); color: white; font-weight: 800; font-size: 14px; padding: 11px 28px; border-radius: 30px; border: 2px solid rgba(255,255,255,0.55); animation: bounce 2s ease-in-out infinite; cursor: pointer; text-decoration: none; display: inline-block; }
  @keyframes bounce { 0%,100% { transform: translateY(0); } 50% { transform: translateY(-7px); } }

  /* BOOKLET */
  .booklet { padding: 36px 20px 80px; max-width: 480px; margin: 0 auto; }
  .section-title { font-family: 'Fredoka One', cursive; font-size: 26px; color: var(--dark); text-align: center; margin-bottom: 28px; }

  /* COUPON */
  .coupon { border-radius: 22px; margin-bottom: 22px; overflow: hidden; box-shadow: 0 8px 28px rgba(0,0,0,0.1); position: relative; transition: transform 0.15s; }
  .coupon:active { transform: scale(0.985); }
  .coupon-body { padding: 22px 22px 10px; display: flex; align-items: flex-start; gap: 16px; }
  .coupon-emoji { font-size: 48px; flex-shrink: 0; filter: drop-shadow(0 2px 4px rgba(0,0,0,0.08)); line-height: 1; }
  .coupon-info { flex: 1; }
  .coupon-label { font-size: 10px; font-weight: 800; letter-spacing: 2.5px; text-transform: uppercase; opacity: 0.6; margin-bottom: 3px; }
  .coupon-title { font-family: 'Fredoka One', cursive; font-size: 26px; color: var(--dark); line-height: 1.1; margin-bottom: 4px; }
  .coupon-desc { font-size: 13px; font-weight: 600; color: var(--dark); opacity: 0.65; line-height: 1.4; }
  .uses-track { display: flex; gap: 7px; margin-top: 12px; flex-wrap: wrap; align-items: center; }
  .pip { width: 28px; height: 28px; border-radius: 50%; border: 2.5px solid rgba(0,0,0,0.2); background: rgba(255,255,255,0.45); display: flex; align-items: center; justify-content: center; font-size: 13px; transition: all 0.25s; font-weight: 800; }
  .pip.used { background: rgba(0,0,0,0.18); border-color: rgba(0,0,0,0.1); color: rgba(255,255,255,0.8); }
  .uses-label { font-size: 11px; font-weight: 800; opacity: 0.55; margin-left: 2px; letter-spacing: 0.5px; }
  .tear { display: flex; align-items: center; padding: 10px 18px 0; opacity: 0.35; }
  .tear-line { flex: 1; border-top: 2px dashed currentColor; }
  .tear-snip { font-size: 15px; padding: 0 8px; transform: rotate(-90deg); }
  .coupon-footer { padding: 10px 22px 16px; display: flex; align-items: center; justify-content: space-between; }
  .redeem-label { font-size: 11px; font-weight: 800; letter-spacing: 1.5px; text-transform: uppercase; opacity: 0.6; }
  .redeem-btn { background: rgba(255,255,255,0.45); border: 2px solid rgba(255,255,255,0.7); color: var(--dark); font-family: 'Fredoka One', cursive; font-size: 15px; padding: 7px 22px; border-radius: 24px; cursor: pointer; transition: all 0.2s; }
  .redeem-btn:hover { background: rgba(255,255,255,0.72); transform: scale(1.04); }
  .redeem-btn:disabled { opacity: 0.4; cursor: not-allowed; transform: none; }
  .coupon.all-used .coupon-body, .coupon.all-used .coupon-footer { opacity: 0.45; }
  .coupon.all-used::after { content: 'ALL USED âœ“'; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -52%) rotate(-11deg); font-family: 'Fredoka One', cursive; font-size: 32px; color: rgba(0,0,0,0.3); border: 3.5px solid rgba(0,0,0,0.22); padding: 4px 16px; border-radius: 8px; letter-spacing: 2px; pointer-events: none; white-space: nowrap; z-index: 10; }

  /* COLOR THEMES */
  .c1 { background: linear-gradient(145deg, #FFD6E7, #FFADD2); }
  .c1 .coupon-label,.c1 .tear,.c1 .redeem-label { color: #C2185B; }
  .c2 { background: linear-gradient(145deg, #E8F5E9, #A5D6A7); }
  .c2 .coupon-label,.c2 .tear,.c2 .redeem-label { color: #2E7D32; }
  .c3 { background: linear-gradient(145deg, #E3F2FD, #90CAF9); }
  .c3 .coupon-label,.c3 .tear,.c3 .redeem-label { color: #1565C0; }
  .c4 { background: linear-gradient(145deg, #FFF9C4, #FFF176); }
  .c4 .coupon-label,.c4 .tear,.c4 .redeem-label { color: #F57F17; }
  .c5 { background: linear-gradient(145deg, #F3E5F5, #CE93D8); }
  .c5 .coupon-label,.c5 .tear,.c5 .redeem-label { color: #6A1B9A; }
  .c6 { background: linear-gradient(145deg, #E0F7FA, #80DEEA); }
  .c6 .coupon-label,.c6 .tear,.c6 .redeem-label { color: #00695C; }
  .c7 { background: linear-gradient(145deg, #FBE9E7, #FFAB91); }
  .c7 .coupon-label,.c7 .tear,.c7 .redeem-label { color: #BF360C; }
  .c8 { background: linear-gradient(145deg, #F9FBE7, #DCE775); }
  .c8 .coupon-label,.c8 .tear,.c8 .redeem-label { color: #558B2F; }
  .c9 { background: linear-gradient(145deg, #FCE4EC, #F48FB1); }
  .c9 .coupon-label,.c9 .tear,.c9 .redeem-label { color: #880E4F; }

  /* MODAL */
  .modal-overlay { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.45); z-index: 100; align-items: center; justify-content: center; padding: 20px; backdrop-filter: blur(4px); }
  .modal-overlay.show { display: flex; }
  .modal { background: white; border-radius: 28px; padding: 36px 28px 28px; max-width: 340px; width: 100%; text-align: center; box-shadow: 0 24px 60px rgba(0,0,0,0.2); animation: popIn 0.25s cubic-bezier(0.175, 0.885, 0.32, 1.275) both; }
  @keyframes popIn { from { transform: scale(0.8); opacity: 0; } to { transform: scale(1); opacity: 1; } }
  .modal-emoji { font-size: 56px; margin-bottom: 12px; }
  .modal-title { font-family: 'Fredoka One', cursive; font-size: 26px; color: var(--dark); margin-bottom: 8px; }
  .modal-body { font-size: 15px; font-weight: 600; color: #666; margin-bottom: 28px; line-height: 1.5; }
  .modal-actions { display: flex; gap: 12px; }
  .btn-cancel { flex: 1; padding: 13px; border-radius: 16px; border: 2.5px solid #eee; background: white; font-family: 'Fredoka One', cursive; font-size: 16px; color: #999; cursor: pointer; transition: all 0.2s; }
  .btn-cancel:hover { background: #f5f5f5; }
  .btn-confirm { flex: 1.4; padding: 13px; border-radius: 16px; border: none; background: linear-gradient(135deg, #FF6B9D, #FF8C69); font-family: 'Fredoka One', cursive; font-size: 16px; color: white; cursor: pointer; transition: all 0.2s; box-shadow: 0 4px 14px rgba(255,107,157,0.4); }
  .btn-confirm:hover { transform: scale(1.03); }

  /* CONFETTI */
  .confetti-piece { position: fixed; pointer-events: none; z-index: 200; animation: confettiFall linear forwards; }
  @keyframes confettiFall { 0% { transform: translateY(-20px) rotate(0deg); opacity: 1; } 100% { transform: translateY(100vh) rotate(720deg); opacity: 0; } }
</style>
</head>
<body>

<section class="cover" id="cover">
  <div class="ticker">
    <span class="ticker-inner">ğŸ’Œ ğŸ² ğŸ“– ğŸµ ğŸ“º ğŸ® ğŸ§ ğŸ™ï¸ ğŸƒ ğŸ¬ ğŸ’Œ ğŸ² ğŸ“– ğŸµ ğŸ“º ğŸ® ğŸ§ ğŸ™ï¸ ğŸƒ ğŸ¬ ğŸ’Œ ğŸ² ğŸ“– ğŸµ ğŸ“º ğŸ® ğŸ§ ğŸ™ï¸ ğŸƒ ğŸ¬ ğŸ’Œ ğŸ² ğŸ“– ğŸµ ğŸ“º ğŸ® ğŸ§ ğŸ™ï¸ ğŸƒ ğŸ¬ &nbsp;</span>
  </div>
  <div class="cover-badge">A Valentine's Gift ğŸ’</div>
  <div class="cover-heart">ğŸ’Œ</div>
  <div class="cover-title">Coupon<br>Booklet</div>
  <div class="cover-sub">Each coupon is a promise to do something you love, even if it makes me mad.</div>
  <a class="scroll-hint" href="#booklet">Open the booklet â†“</a>
</section>

<section class="booklet" id="booklet">
  <div class="section-title">âœ‚ï¸ Your Coupons</div>
  <div id="coupons-container"></div>
</section>

<div class="modal-overlay" id="modal">
  <div class="modal">
    <div class="modal-emoji" id="modal-emoji">ğŸ‰</div>
    <div class="modal-title" id="modal-title">Are you sure?</div>
    <div class="modal-body" id="modal-body">Ready to redeem this coupon?</div>
    <div class="modal-actions">
      <button class="btn-cancel" onclick="closeModal()">Not yet</button>
      <button class="btn-confirm" onclick="confirmRedeem()">Yes, redeem! ğŸ‰</button>
    </div>
  </div>
</div>

<script>
const COUPONS = [
  { id: 'book',      emoji: 'ğŸ“–', color: 'c1', title: 'Read a Book',           desc: "You pick it, I read it. Even if it's 600 pages of fantasy.", total: 1 },
  { id: 'album',     emoji: 'ğŸµ', color: 'c2', title: 'Listen to an Album',    desc: "Give me your worst.", total: 1 },
  { id: 'show',      emoji: 'ğŸ“º', color: 'c3', title: 'Watch a Full Series',   desc: "An entire show. Start to finish. No 'can we watch something else?'", total: 1 },
  { id: 'movie',     emoji: 'ğŸ¬', color: 'c4', title: 'Watch a Movie',         desc: "Your pick, my full attention. Three whole movies!", total: 3 },
  { id: 'videogame', emoji: 'ğŸ®', color: 'c5', title: 'Play a Video Game',     desc: "Even Elden Ring.", total: 1 },
  { id: 'audiobook', emoji: 'ğŸ§', color: 'c6', title: 'Audiobook Together',    desc: "We listen together. Yes, even Dungeon Crawler Carl.", total: 1 },
  { id: 'rpg',       emoji: 'ğŸ²', color: 'c7', title: 'DM a One-Shot RPG',     desc: "I'll DM a whole adventure for you + friends.", total: 1 },
  { id: 'boardgame', emoji: 'ğŸƒ', color: 'c8', title: 'Play a Board Game',     desc: "This one's hard, but I won't even say \"this should be a video game\".", total: 1 },
  { id: 'podcast',   emoji: 'ğŸ™ï¸', color: 'c9', title: 'Listen to a Podcast',  desc: "Three episodes of Dwarkesh or other AI dorks.", total: 3 },
];

const KEY = 'valentine-coupons-2026';
let state = {};
let pendingId = null;

try { state = JSON.parse(localStorage.getItem(KEY) || '{}'); } catch {}

function save() {
  try { localStorage.setItem(KEY, JSON.stringify(state)); } catch {}
}

function used(id) { return state[id] || 0; }

function render() {
  const el = document.getElementById('coupons-container');
  el.innerHTML = '';
  COUPONS.forEach(c => {
    const u = used(c.id);
    const done = u >= c.total;
    const label = c.total === 1 ? 'One-Time Use' : `${c.total} Uses`;
    const usedText = c.total === 1 ? (done ? 'Used!' : 'One-time') : `${u} of ${c.total} used`;

    let pips = '';
    for (let i = 0; i < c.total; i++) {
      pips += `<div class="pip${i < u ? ' used' : ''}">${i < u ? 'âœ“' : 'â—'}</div>`;
    }

    const d = document.createElement('div');
    d.className = `coupon ${c.color}${done ? ' all-used' : ''}`;
    d.id = `coupon-${c.id}`;
    d.innerHTML = `
      <div class="coupon-body">
        <div class="coupon-emoji">${c.emoji}</div>
        <div class="coupon-info">
          <div class="coupon-label">${label}</div>
          <div class="coupon-title">${c.title}</div>
          <div class="coupon-desc">${c.desc}</div>
          <div class="uses-track">${pips}<span class="uses-label">${usedText}</span></div>
        </div>
      </div>
      <div class="tear"><div class="tear-line"></div><span class="tear-snip">âœ‚ï¸</span><div class="tear-line"></div></div>
      <div class="coupon-footer">
        <span class="redeem-label">${done ? 'ğŸ‰ All done!' : 'Tap to redeem'}</span>
        <button class="redeem-btn" onclick="openModal('${c.id}')" ${done ? 'disabled' : ''}>${done ? 'Used Up!' : 'Redeem ğŸ‰'}</button>
      </div>
    `;
    el.appendChild(d);
  });
}

function openModal(id) {
  pendingId = id;
  const c = COUPONS.find(x => x.id === id);
  const remaining = c.total - used(id);
  document.getElementById('modal-emoji').textContent = c.emoji;
  document.getElementById('modal-title').textContent = `Redeem "${c.title}"?`;
  document.getElementById('modal-body').textContent = remaining > 1
    ? `You'll use 1 of your ${remaining} remaining uses. Ready?`
    : `This is your last use â€” make it count! ğŸ‰`;
  document.getElementById('modal').classList.add('show');
}

function closeModal() {
  document.getElementById('modal').classList.remove('show');
  pendingId = null;
}

function confirmRedeem() {
  if (!pendingId) return;
  state[pendingId] = used(pendingId) + 1;
  save();
  closeModal();
  render();
  setTimeout(() => {
    const el = document.getElementById(`coupon-${pendingId}`);
    if (el) el.scrollIntoView({ behavior: 'smooth', block: 'center' });
  }, 100);
  confetti();
}

function confetti() {
  const colors = ['#FF6B9D','#FFE566','#7FDBCA','#FF8C69','#C084FC','#90CAF9'];
  for (let i = 0; i < 45; i++) {
    const el = document.createElement('div');
    el.className = 'confetti-piece';
    const size = 6 + Math.random() * 9;
    el.style.cssText = `left:${Math.random()*100}vw;top:-10px;width:${size}px;height:${size}px;background:${colors[Math.floor(Math.random()*colors.length)]};border-radius:${Math.random()>.5?'50%':'3px'};animation-duration:${1.2+Math.random()*1.4}s;animation-delay:${Math.random()*0.5}s;`;
    document.body.appendChild(el);
    el.addEventListener('animationend', () => el.remove());
  }
}

document.getElementById('modal').addEventListener('click', e => { if (e.target === document.getElementById('modal')) closeModal(); });

render();
</script>
</body>
</html>
